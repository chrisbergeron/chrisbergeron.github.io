<!doctype html>
<html lang="en"><head><meta charset="utf-8"><link rel="bookmark" type="image/x-icon" href="/images/icons/logo-apple-icon.png"><link rel="shortcut icon" href="/images/icons/logo-apple-icon.png"><link rel="shortcut icon" type="image/vnd.microsoft.icon" href="/images/icons/favicon.ico"><link rel="apple-touch-icon" type="image/png" sizes="16x16" href="/images/icons/apple-touch-icon-16.png"><link rel="apple-touch-icon" type="image/png" sizes="29x29" href="/images/icons/apple-touch-icon-29.png"><link rel="apple-touch-icon" type="image/png" sizes="32x32" href="/images/icons/apple-touch-icon-32.png"><link rel="apple-touch-icon" type="image/png" sizes="40x40" href="/images/icons/apple-touch-icon-40.png"><link rel="apple-touch-icon" type="image/png" sizes="50x50" href="/images/icons/apple-touch-icon-50.png"><link rel="apple-touch-icon" type="image/png" sizes="57x57" href="/images/icons/apple-touch-icon-57.png"><link rel="apple-touch-icon" type="image/png" sizes="58x58" href="/images/icons/apple-touch-icon-58.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="/images/icons/apple-touch-icon-60.png"><link rel="apple-touch-icon" type="image/png" sizes="64x64" href="/images/icons/apple-touch-icon-64.png"><link rel="apple-touch-icon" type="image/png" sizes="72x72" href="/images/icons/apple-touch-icon-72.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="/images/icons/apple-touch-icon-76.png"><link rel="apple-touch-icon" type="image/png" sizes="80x80" href="/images/icons/apple-touch-icon-80.png"><link rel="apple-touch-icon" type="image/png" sizes="87x87" href="/images/icons/apple-touch-icon-87.png"><link rel="apple-touch-icon" type="image/png" sizes="100x100" href="/images/icons/apple-touch-icon-100.png"><link rel="apple-touch-icon" type="image/png" sizes="114x114" href="/images/icons/apple-touch-icon-114.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="/images/icons/apple-touch-icon-120.png"><link rel="apple-touch-icon" type="image/png" sizes="128x128" href="/images/icons/apple-touch-icon-128.png"><link rel="apple-touch-icon" type="image/png" sizes="144x144" href="/images/icons/apple-touch-icon-144.png"><link rel="apple-touch-icon" type="image/png" sizes="152x152" href="/images/icons/apple-touch-icon-152.png"><link rel="apple-touch-icon" type="image/png" sizes="167x167" href="/images/icons/apple-touch-icon-167.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="/images/icons/apple-touch-icon-180.png"><link rel="apple-touch-icon" type="image/png" sizes="256x256" href="/images/icons/apple-touch-icon-256.png"><link rel="apple-touch-icon" type="image/png" sizes="512x512" href="/images/icons/apple-touch-icon-512.png"><link rel="apple-touch-icon" type="image/png" sizes="1024x1024" href="/images/icons/apple-touch-icon-1024.png"><link rel="icon" type="image/png" href="/images/icons/apple-touch-icon-114.png"><meta name="description" content="An online technology journal with how-to articles, projects and examples."><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5"><meta><script src="/mc.js"></script><title>Speeding up Ansible Playbook runs - Chris Bergeron Tech Blog</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="Chris Bergerons Tech Blog"><meta name="msapplication-TileImage" content="/images/favicon.ico"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="Chris Bergerons Tech Blog"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="Ansible is a great tool for configuration management but because of the way it’s designed a common complaint is that it’s not as fast as other tools like Salt, Chef or Puppet.  This is because Ansible"><meta property="og:type" content="article"><meta property="og:title" content="Chris Bergeron Tech Blog"><meta property="og:url" content="https://chrisbergeron.com/2018/06/08/ansible_performance_tuning/"><meta property="og:site_name" content="Chris Bergerons Tech Blog"><meta property="og:description" content="Ansible is a great tool for configuration management but because of the way it’s designed a common complaint is that it’s not as fast as other tools like Salt, Chef or Puppet.  This is because Ansible"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://chrisbergeron.com/images/cb-cover.jpg"><meta property="article:published_time" content="2018-06-08T23:13:25.000Z"><meta property="article:modified_time" content="2021-09-02T21:20:23.677Z"><meta property="article:author" content="Chris Bergeron"><meta property="article:tag" content="devops"><meta property="article:tag" content="ansible"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="https://chrisbergeron.com/images/cb-cover.jpg"><meta property="twitter:creator" content="@bergeron"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://chrisbergeron.com"},"headline":"Chris Bergeron Tech Blog","image":["https://chrisbergeron.com/images/cover-ansible_performance_tuning.jpg"],"datePublished":"2018-06-08T23:13:25.000Z","dateModified":"2021-09-02T21:20:23.677Z","author":{"@type":"Person","name":"Chris Bergeron"},"description":"Ansible is a great tool for configuration management but because of the way it’s designed a common complaint is that it’s not as fast as other tools like Salt, Chef or Puppet.  This is because Ansible"}</script><link rel="canonical" href="https://chrisbergeron.com/2018/06/08/ansible_performance_tuning/"><link rel="alternate" href="/" title="Chris Bergeron Tech Blog" type="application/atom+xml"><link rel="icon" href="/images/favicon.ico"><link rel="stylesheet" href="/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-dark.css"><link rel="stylesheet" href="/css/source-code-pro.css"><link rel="stylesheet" href="/css/default.dark.css" media="(prefers-color-scheme: dark)" id="theme-link"><link rel="stylesheet" href="/css/default.light.css" media="(prefers-color-scheme: light)" id="theme-link"><!--!--><!--!--><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css"><script src="https://www.googletagmanager.com/gtag/js?id=G-5MJNLK80PN" async></script><script>window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
    
        gtag('config', 'G-5MJNLK80PN');</script><!--!--><!--!--><!--!--><meta name="generator" content="Hexo 5.4.0"></head><body class="is-2-column"><nav class="navbar navbar-main"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/images/logo.png" alt="Chris Bergeron Tech Blog" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/about">About</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="RSS Feed" href="https://chrisbergeron.com/rss2.xml"><i class="fa fa-rss fa-1x"></i></a><a class="navbar-item search" title="Search" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-8-widescreen"><div class="card"><div class="card-image"><span class="image is-7by3"><img class="fill" src="/images/cover-ansible_performance_tuning.jpg" alt="Speeding up Ansible Playbook runs"></span></div><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2018-06-08T23:13:25.000Z" title="2018-06-08T23:13:25.000Z">06-08-2018</time></span><span class="level-item">Updated&nbsp;<time dateTime="2021-09-02T21:20:23.677Z" title="2021-09-02T21:20:23.677Z">09-02-2021</time></span><span class="level-item"><a class="link-muted" href="/categories/Linux/">Linux</a></span></div></div><h1 class="title is-3 is-size-4-mobile">Speeding up Ansible Playbook runs</h1><div class="content"><p>Ansible is a great tool for configuration management but because of the way it’s designed a common complaint is that it’s not as fast as other tools like Salt, Chef or Puppet.  This is because Ansible doesn’t have an agent that listens (although it can) on a host and uses a different type of deployment methodology that is based on SSH.  This post isn’t about the pros and cons of each tool, but rather about ways to improve upon Ansible’s default configuration values.  By default Ansible ships with very conservative default values.  This is smart in my opinion because it offers greater compatibility out-of-the-box.  Here I highlight some safe adjustments that can be made to the default configuration for improved performance (speed!)</p>
<h3 id="Real-World-Playbook-Test"><a href="#Real-World-Playbook-Test" class="headerlink" title="Real World Playbook Test"></a>Real World Playbook Test</h3><p>For this test I’m using a real-world playbook that I use in my homelab when provisioning a new CentOS VM.  It configures some basic things (hostname, ssh keys, etc), installs common packages/utilities and tunes some OS configurations.<br><span id="more"></span><br>The VM I’m running the playbook from is on a Centos 7 VM running on an ESXi 6.5 Host.  The playbook will be running against <strong>12 target VMs.</strong>  The VMs it will be talking to are on the same VMNetwork.  The Ansible VM has 4 vCPUs and 8GB of ram.</p>
<p>Before tuning Ansible, we’ll need to gather some metrics about how each playbook run performs.  Fortunately in Ansible v2.0 and higher there are two built in callbacks that can be enabled: <code>timer</code> and <code>profile_tasks</code>  Timer will output the total playbook run time, similar to running the <code>time</code> command before an <code>ansible-playbook</code> command.  The second and more interesting of the two IMO is <code>profile_tasks</code>.  This callback displays a nice summary of each TASK and how long it took to execute.  To enable these settings edit (or create) an <code>ansible.cfg</code> file.  You can check to see if you already have an Ansible config file by running:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ ansible --version</span><br><span class="line">ansible 2.5.3</span><br><span class="line">  config file = /home/directory/ansible/ansible.cfg</span><br></pre></td></tr></table></figure>
<p>This tells you the location of the configuration file that Ansible uses and the version.  If you don’t see a config file listed you can create one in the directory where your playbooks will be run.</p>
<p>We’re going to add the following line to the config file under the <code>[defaults]</code> subsection:</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[<span class="string">defaults</span>]</span><br><span class="line"><span class="string">callback_whitelist</span> <span class="string">=</span> <span class="string">timer,</span> <span class="string">profile_tasks</span></span><br></pre></td></tr></table></figure>
<p>I’m running the follwing playbook command:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ansible-playbook init_centos.yml -e @group_vars/vault.yml --<span class="built_in">limit</span> vms</span><br></pre></td></tr></table></figure>
<p>Here’s the output from the playbook run with the default configuration:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">Friday 08 June 2018  16:04:29 -0400 (0:00:16.486) 0:02:04.805 ***</span><br><span class="line">&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;</span><br><span class="line">TASK | Install packages ---------------------------------- 20.73s</span><br><span class="line">TASK | Start filebeat and enable service ----------------- 16.49s</span><br><span class="line">TASK | Install filebeat ----------------------------------- 6.15s</span><br><span class="line">Gathering Facts ------------------------------------------- 5.76s</span><br><span class="line">TASK | Install rpms for Spacewalk &#x2F; RHN ------------------- 5.15s</span><br><span class="line">checkmk : TASK | Copy Checkmk Agent Listener -------------- 2.81s</span><br><span class="line">checkmk : TASK | Copy Checkmk Agent ----------------------- 2.52s</span><br><span class="line">TASK | Copy Influxdata repo (for Telegraf) ---------------- 2.22s</span><br><span class="line">TASK | Ensure mount directories exist --------------------- 2.21s</span><br><span class="line">TASK | Copy Telegraf config ------------------------------- 2.18s</span><br><span class="line">TASK | Copy filebeat config template ---------------------- 2.17s</span><br><span class="line">TASK | Copy user ssh&#x2F;config  ------------------------------ 2.16s</span><br><span class="line">TASK | Update &#x2F;etc&#x2F;services file -------------------------- 2.14s</span><br><span class="line">TASK | Set &#x2F;etc&#x2F;hostname ---------------------------------- 2.13s</span><br><span class="line">TASK | Disable SELinux (Centos 7) ------------------------- 2.10s</span><br><span class="line">TASK | Copy ssh keys -------------------------------------- 2.09s</span><br><span class="line">TASK | Install prowl -------------------------------------- 2.09s</span><br><span class="line">TASK | Copy .bash_logout for user ------------------------- 2.08s</span><br><span class="line">TASK | Copy .bashrc for user ------------------------------ 2.08s</span><br><span class="line">TASK | Copy iTerm2 bash shell integration for user -------- 2.07s</span><br><span class="line">Playbook run took 0 days, 0 hours, 2 minutes, 4 seconds</span><br></pre></td></tr></table></figure>
<p>The important line here is the last one:  <strong>Playbook run took … 2 minutes, 4 seconds</strong>  That’s <strong>124</strong> seconds.  Not terrible, but if you’re deploying to a large number of machines (say 50 or 100) those minutes can quickly add up.</p>
<p>Let’s start making some configuration tweaks and see if we can speed things up.</p>
<h3 id="Enable-SSH-Pipelining"><a href="#Enable-SSH-Pipelining" class="headerlink" title="Enable SSH Pipelining"></a>Enable SSH Pipelining</h3><p>To enable SSH pipelining, add this to your ansible.cfg file under the <code>[defaults]</code> heading:</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">pipelining</span> <span class="string">=</span> <span class="literal">True</span></span><br></pre></td></tr></table></figure>
<p>From the <a target="_blank" rel="noopener" href="https://docs.ansible.com/ansible/2.4/intro_configuration.html#pipelining">Ansible manual</a>: <em>Enabling pipelining reduces the number of SSH operations required to execute a module on the remote server, by executing many ansible modules without actual file transfer.</em>  </p>
<p>Let’s run the same playbook again but with this configuration option set and see what happens:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">Friday 08 June 2018  16:07:19 -0400 (0:00:23.585) 0:01:56.055 ***</span><br><span class="line">&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;</span><br><span class="line">TASK | Start filebeat and enable service ----------------- 23.58s</span><br><span class="line">TASK | Install packages ---------------------------------- 16.75s</span><br><span class="line">TASK | Install filebeat ----------------------------------- 6.17s</span><br><span class="line">Gathering Facts ------------------------------------------- 5.50s</span><br><span class="line">TASK | Install rpms for Spacewalk &#x2F; RHN ------------------- 4.61s</span><br><span class="line">checkmk : TASK | Copy Checkmk Agent Listener -------------- 2.33s</span><br><span class="line">checkmk : TASK | Copy Checkmk Agent ----------------------- 2.26s</span><br><span class="line">TASK | Set &#x2F;etc&#x2F;hostname ---------------------------------- 1.91s</span><br><span class="line">TASK | Copy Influxdata repo (for Telegraf) ---------------- 1.90s</span><br><span class="line">TASK | Copy ssh&#x2F;config for user --------------------------- 1.88s</span><br><span class="line">TASK | Copy ssh keys for user ----------------------------- 1.87s</span><br><span class="line">TASK | Copy .bash_logout for user ------------------------- 1.83s</span><br><span class="line">TASK | Copy Telegraf config ------------------------------- 1.82s</span><br><span class="line">TASK | Update &#x2F;etc&#x2F;services file -------------------------- 1.82s</span><br><span class="line">TASK | Copy .bashrc for user  ----------------------------- 1.82s</span><br><span class="line">TASK | Copy Telegraf environment default ------------------ 1.81s</span><br><span class="line">TASK | Copy .bashrc for root ------------------------------ 1.80s</span><br><span class="line">TASK | Install prowl -------------------------------------- 1.79s</span><br><span class="line">TASK | Install prowl API key ------------------------------ 1.77s</span><br><span class="line">TASK | Copy .bash_logout for root ------------------------- 1.77s</span><br><span class="line">Playbook run took 0 days, 0 hours, 1 minutes, 55 seconds</span><br></pre></td></tr></table></figure>
<p>Here we can see that the play run completed <strong>9 seconds faster</strong>.  Not bad.  Let’s see if we can tweak it some more.</p>
<h3 id="Reduce-poll-interval-to-5s"><a href="#Reduce-poll-interval-to-5s" class="headerlink" title="Reduce poll interval to 5s"></a>Reduce poll interval to 5s</h3><p>The default poll interval is set to 15 seconds.  This is how often Ansible will check on task that’s running and decide if it can proceed.  Let’s set it to 5 seconds and see what happens.  Add or edit this line in the ansible.cfg file, again under the <code>[defaults]</code> heading:</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">poll_interval</span> <span class="string">=</span> <span class="number">5</span></span><br></pre></td></tr></table></figure>
<p>Let’s run it:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">Friday 08 June 2018  16:10:09 -0400 (0:00:13.277) 0:01:46.888 ***</span><br><span class="line">&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;</span><br><span class="line">TASK | Install packages ---------------------------------- 18.66s</span><br><span class="line">TASK | Start filebeat and enable service ----------------- 13.28s</span><br><span class="line">TASK | Install filebeat ----------------------------------- 5.61s</span><br><span class="line">Gathering Facts ------------------------------------------- 5.50s</span><br><span class="line">TASK | Install rpms for Spacewalk &#x2F; RHN ------------------- 4.77s</span><br><span class="line">checkmk : TASK | Copy Checkmk Agent Listener -------------- 2.33s</span><br><span class="line">checkmk : TASK | Copy Checkmk Agent ----------------------- 2.19s</span><br><span class="line">TASK | Copy filebeat config template ---------------------- 2.01s</span><br><span class="line">TASK | Copy ssh&#x2F;config for user  -------------------------- 1.87s</span><br><span class="line">TASK | Copy Telegraf environment default ------------------ 1.86s</span><br><span class="line">TASK | Set &#x2F;etc&#x2F;hostname ---------------------------------- 1.86s</span><br><span class="line">TASK | Copy ssh keys for user  ---------------------------- 1.84s</span><br><span class="line">TASK | Copy Influxdata repo (for Telegraf) ---------------- 1.84s</span><br><span class="line">TASK | Copy .bash_logout for root ------------------------- 1.80s</span><br><span class="line">TASK | Update &#x2F;etc&#x2F;services file -------------------------- 1.79s</span><br><span class="line">TASK | Install prowlnotify -------------------------------- 1.77s</span><br><span class="line">TASK | Copy .bashrc for root ------------------------------ 1.77s</span><br><span class="line">TASK | Copy .bash_logout for user ------------------------- 1.76s</span><br><span class="line">TASK | Copy .bashrc for user ------------------------------ 1.76s</span><br><span class="line">TASK | Copy  sudoers file --------------------------------- 1.76s</span><br><span class="line">Playbook run took 0 days, 0 hours, 1 minutes, 46 seconds</span><br></pre></td></tr></table></figure>
<p>It took <strong>106</strong> seconds to run the playbook that time.  That’s <strong>18 seconds faster</strong> than what we started with.  Nice.  </p>
<p>Let’s try another tweak and see if we can’t do even better.</p>
<h3 id="Increase-forks-to-25"><a href="#Increase-forks-to-25" class="headerlink" title="Increase forks to 25"></a>Increase forks to 25</h3><p>For my use case I’m increasing the number of simultaneous forks to <strong>25</strong> from the default value of <strong>5</strong>.  Again, Ansible ships with pretty sane defaults.  We don’t want sane, we want fast.  Let’s see how how this does:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">Friday 08 June 2018  16:12:10 -0400 (0:00:17.528) 0:01:25.858 ***</span><br><span class="line">&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D; </span><br><span class="line">TASK | Start filebeat and enable service ----------------- 17.53s</span><br><span class="line">TASK | Install packages ---------------------------------- 10.29s</span><br><span class="line">TASK | Install filebeat ----------------------------------- 8.51s</span><br><span class="line">Gathering Facts ------------------------------------------- 3.77s</span><br><span class="line">TASK | Install rpms for Spacewalk &#x2F; RHN ------------------- 3.01s</span><br><span class="line">checkmk : TASK | Copy Checkmk Agent Listener -------------- 1.59s</span><br><span class="line">TASK | Disable SELinux (Centos 7) ------------------------- 1.40s</span><br><span class="line">TASK | Update &#x2F;etc&#x2F;services file -------------------------- 1.39s</span><br><span class="line">TASK | Install prowlnotify -------------------------------- 1.39s</span><br><span class="line">checkmk : TASK | Copy Checkmk Agent ----------------------- 1.36s</span><br><span class="line">TASK | Copy  sudoers file --------------------------------- 1.30s</span><br><span class="line">TASK | Copy Telegraf config ------------------------------- 1.30s</span><br><span class="line">TASK | Install treesize in &#x2F;usr&#x2F;local&#x2F;bin ----------------- 1.29s</span><br><span class="line">TASK | Copy .bash_logout for user ------------------------- 1.27s</span><br><span class="line">TASK | Copy .bashrc for root ------------------------------ 1.27s</span><br><span class="line">TASK | Install prowl -------------------------------------- 1.25s</span><br><span class="line">TASK | Copy .bash_logout for root ------------------------- 1.23s</span><br><span class="line">TASK | Copy ssh&#x2F;config for user --------------------------- 1.23s</span><br><span class="line">TASK | Copy filebeat config template ---------------------- 1.22s</span><br><span class="line">TASK | Copy Telegraf environment default ------------------ 1.22s</span><br><span class="line">Playbook run took 0 days, 0 hours, 1 minutes, 25 seconds</span><br></pre></td></tr></table></figure>
<p>Very nice.  Now we’re at <strong>85</strong> seconds.  Remember, I’m running the <em>exact same playbook</em> just with new configuration values (options).  This is very good but I think there’s more we can do.</p>
<h3 id="Enable-fact-caching"><a href="#Enable-fact-caching" class="headerlink" title="Enable fact_caching"></a>Enable fact_caching</h3><p>By enabling this value we’re telling Ansible to keep the facts it gathers in a local file.  You can also set this to a redis cache.  See the documentation for details.<br>Fact_caching is what happens when Ansible says, “Gathering facts” about your target hosts.  If we don’t change our targets hardware (or virtual hardware) very often this can be very helpful.  Enable it by adding this to your ansible.cfg file:</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">fact_caching</span>            <span class="string">=</span> <span class="string">jsonfile</span></span><br><span class="line"><span class="string">fact_caching_connection</span> <span class="string">=</span> <span class="string">/tmp/.ansible_fact_cache</span></span><br></pre></td></tr></table></figure>
<p>What happens when we run it now?</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">Friday 08 June 2018  17:25:14 -0400 (0:00:03.000) 0:01:15.530 ***</span><br><span class="line">&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;</span><br><span class="line">TASK | Install packages ---------------------------------- 17.33s</span><br><span class="line">TASK | Install filebeat ----------------------------------- 4.46s</span><br><span class="line">TASK | Install rpms for Spacewalk &#x2F; RHN ------------------- 3.87s</span><br><span class="line">Gathering Facts ------------------------------------------- 3.82s</span><br><span class="line">TASK | Start filebeat and enable service ------------------ 3.00s</span><br><span class="line">checkmk : TASK | Copy Checkmk Agent Listener -------------- 2.34s</span><br><span class="line">checkmk : TASK | Copy Checkmk Agent ----------------------- 1.47s</span><br><span class="line">TASK | Install prowl -------------------------------------- 1.40s</span><br><span class="line">TASK | Update &#x2F;etc&#x2F;services file -------------------------- 1.38s</span><br><span class="line">TASK | Install prowlnotify -------------------------------- 1.33s</span><br><span class="line">TASK | Set &#x2F;etc&#x2F;hostname ---------------------------------- 1.33s</span><br><span class="line">TASK | Ensure mount directories exist --------------------- 1.28s</span><br><span class="line">TASK | Copy iTerm2 bash shell integration for user -------- 1.27s</span><br><span class="line">TASK | Copy Telegraf environment default ------------------ 1.25s</span><br><span class="line">TASK | Copy Influxdata repo (for Telegraf) ---------------- 1.24s</span><br><span class="line">TASK | Copy .bash_logout for user ------------------------- 1.23s</span><br><span class="line">TASK | Copy .bashrc for user ------------------------------ 1.22s</span><br><span class="line">TASK | Copy .bashrc for root ------------------------------ 1.21s</span><br><span class="line">TASK | Disable SELinux (Centos 7) ------------------------- 1.20s</span><br><span class="line">checkmk : TASK | Create Checkmk Agent Unit ---------------- 1.20s</span><br><span class="line">**Playbook run took 0 days, 0 hours, 1 minutes, 15 seconds**</span><br></pre></td></tr></table></figure>
<p><strong>75 seconds</strong>.  <em>Very nice.</em>  These tweaks have made a huge difference.</p>
<h3 id="Let’s-recap"><a href="#Let’s-recap" class="headerlink" title="Let’s recap"></a>Let’s recap</h3><p>We’ve reduced our playbook run time from <strong>2 minutes and 4 seconds</strong> down to <strong>1 minute and 15 seconds</strong>.  (<strong>184 seconds -&gt; 75 seconds</strong>)  That’s <strong>40%</strong> less time to run the <em>exact same</em> playbook with just a few configuration tweaks.</p>
<p>By adding / editing these configuration values we were able to cut our playbook run time nearly in half.  Now, these results aren’t going to be the same for everyone, every playbook or every environment.  There are many factors that account for Ansible performance.  </p>
<p>It’s clear, however, that modifying the defaults as we did here results in significant performance gains and can save you time on deployments.</p>
<p><em>( I’ll add a pretty table with summary here someday. )</em></p>
</div><div class="article-licensing box"><div class="licensing-title"><p>Speeding up Ansible Playbook runs</p><p><a href="https://chrisbergeron.com/2018/06/08/ansible_performance_tuning/">https://chrisbergeron.com/2018/06/08/ansible_performance_tuning/</a></p></div><div class="licensing-meta level is-mobile"><div class="level-left"><div class="level-item is-narrow"><div><h6>Author</h6><p>Chris Bergeron</p></div></div><div class="level-item is-narrow"><div><h6>Posted on</h6><p>06-08-2018</p></div></div><div class="level-item is-narrow"><div><h6>Updated on</h6><p>09-02-2021</p></div></div><div class="level-item is-narrow"><div><h6>Licensed under</h6><p><a class="icon" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a><a class="icon" rel="noopener" target="_blank" title="Attribution" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a><a class="icon" rel="noopener" target="_blank" title="Noncommercial" href="https://creativecommons.org/licenses/by-nc/4.0/"><i class="fab fa-creative-commons-nc"></i></a></p></div></div></div></div></div><div class="article-tags is-size-7 mb-4"><span class="mr-2">#</span><a class="link-muted mr-2" rel="tag" href="/tags/devops/">devops</a><a class="link-muted mr-2" rel="tag" href="/tags/ansible/">ansible</a></div><!--!--></article></div><div class="card"><div class="card-content"><h3 class="menu-label has-text-centered">Like this article? Support me with</h3><div class="buttons is-centered"><a class="button donate" href="https://www.buymeacoffee.com/cbergeron" target="_blank" rel="noopener" data-type="buymeacoffee"><span class="icon is-small"><i class="fas fa-coffee"></i></span><span>Buy me a coffee</span></a><a class="button donate" href="/" target="_blank" rel="noopener" data-type="patreon"><span class="icon is-small"><i class="fab fa-patreon"></i></span><span>Patreon</span></a><a class="button donate" data-type="paypal" onclick="document.getElementById(&#039;paypal-donate-form&#039;).submit()"><span class="icon is-small"><i class="fab fa-paypal"></i></span><span>Paypal</span></a><form action="https://www.paypal.com/cgi-bin/webscr" method="post" target="_blank" rel="noopener" id="paypal-donate-form"><input type="hidden" name="cmd" value="_donations"><input type="hidden" name="business" value="cbergeron@gmail.com"><input type="hidden" name="currency_code" value="USD"></form></div></div></div><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/2018/06/11/nzbget_elasticsearch_script/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">NZBGet ElasticSearch Plugin</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/2018/06/04/pfsense_4g_lte_cellular_modem_wan_backup/"><span class="level-item">Pfsense WAN with Cellular LTE/4G</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><div class="card"><div class="card-content"><h3 class="title is-5">Comments</h3><div id="disqus_thread"><noscript>Please enable JavaScript to view the <a target="_blank" rel="noopener" href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div><script>var disqus_config = function () {
            this.page.url = 'https://chrisbergeron.com/2018/06/08/ansible_performance_tuning/';
            this.page.identifier = '2018/06/08/ansible_performance_tuning/';
        };
        (function() {
            var d = document, s = d.createElement('script');  
            s.src = '//' + 'cbergeron' + '.disqus.com/embed.js';
            s.setAttribute('data-timestamp', +new Date());
            (d.head || d.body).appendChild(s);
        })();</script></div></div></div><!--!--><div class="column column-right is-4-tablet is-4-desktop is-4-widescreen  order-3 is-sticky"><!--!--><div class="card widget" data-type="subscribe-email"><div class="card-content"><div class="menu"><h3 class="menu-label">Subscribe for more great content</h3><form action="https://chrisbergeron.us6.list-manage.com/subscribe/post?u=adaa13382eeaddeabadbb90bf&amp;id=73e551a962" method="post" id="mc-embedded-subscribe-form" target="_blank" name="mc-embedded-subscribe-form"><input type="hidden" value="ChrisBergeron" name="uri"><input type="hidden" name="loc" value="en_US"><input type="hidden" name="u" value="adaa13382eeaddeabadbb90bf"><input type="hidden" name="id" value="73e551a962"><div class="field has-addons"><div class="control has-icons-left is-expanded"><input class="input" type="email" name="MERGE0" id="MERGE0" autocapitalize="off" autocorrect="off" size="25" value="" placeholder="Email"><span class="icon is-small is-left"><i class="fas fa-envelope"></i></span></div><div class="control"><input class="button" type="submit" value="Subscribe"></div></div><p class="help">Chris Bergerons Tech Blog</p></form></div></div></div><div class="card widget" data-type="links"><div class="card-content"><div class="menu"><h3 class="menu-label">Links</h3><ul class="menu-list"><li><a class="level is-mobile" href="https://holdingco.com" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">The Holding Company</span></span><span class="level-right"><span class="level-item tag">holdingco.com</span></span></a></li><li><a class="level is-mobile" href="https://debris-art.com" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Debris Art</span></span><span class="level-right"><span class="level-item tag">debris-art.com</span></span></a></li><li><a class="level is-mobile" href="https://metacrypt.io" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">MΞTΛcrypt</span></span><span class="level-right"><span class="level-item tag">metacrypt.io</span></span></a></li></ul></div></div></div><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">Recents</h3><article class="media"><div class="media-content"><p class="date"><time dateTime="2021-09-03T21:45:21.000Z">09-03-2021</time></p><p class="title"><a href="/2021/09/03/about/"> </a></p></div></article><article class="media"><figure class="media-left"><a class="image" href="/2021/08/23/Hands-On-with-the-Gigabyte-Maple-Ridge-Thunderbolt-4-Card/"><img src="/images/thunderbolt-tbt-icon.png" alt="Hands On with the Gigabyte Maple Ridge Thunderbolt 4 Card"></a></figure><div class="media-content"><p class="date"><time dateTime="2021-08-23T18:22:20.000Z">08-23-2021</time></p><p class="title"><a href="/2021/08/23/Hands-On-with-the-Gigabyte-Maple-Ridge-Thunderbolt-4-Card/">Hands On with the Gigabyte Maple Ridge Thunderbolt 4 Card</a></p><p class="categories"><a href="/categories/Homelab/">Homelab</a></p></div></article><article class="media"><figure class="media-left"><a class="image" href="/2021/08/14/Controlling-iRobot-Roomba-from-the-command-line/"><img src="/images/irobot.png" alt="Controlling iRobot Roomba from the command line"></a></figure><div class="media-content"><p class="date"><time dateTime="2021-08-14T13:40:20.000Z">08-14-2021</time></p><p class="title"><a href="/2021/08/14/Controlling-iRobot-Roomba-from-the-command-line/">Controlling iRobot Roomba from the command line</a></p><p class="categories"><a href="/categories/Home/">Home</a></p></div></article><article class="media"><figure class="media-left"><a class="image" href="/2021/08/11/Fast-RAID-0-DAS-Using-Multiple-Thunderbolt-4-Busses/"><img src="/images/thunderbolt-tbt-icon.png" alt="Fast RAID-0 DAS Using Two Thunderbolt 3 Enclosures"></a></figure><div class="media-content"><p class="date"><time dateTime="2021-08-11T14:46:52.000Z">08-11-2021</time></p><p class="title"><a href="/2021/08/11/Fast-RAID-0-DAS-Using-Multiple-Thunderbolt-4-Busses/">Fast RAID-0 DAS Using Two Thunderbolt 3 Enclosures</a></p><p class="categories"><a href="/categories/Homelab/">Homelab</a></p></div></article><article class="media"><figure class="media-left"><a class="image" href="/2021/07/25/Ultra-fast-Thunderbolt-NAS-with-Apple-M1-and-Linux/"><img src="/images/thunderbolt-tbt-icon.png" alt="Ultra fast Thunderbolt NAS with Apple M1 and Linux"></a></figure><div class="media-content"><p class="date"><time dateTime="2021-07-26T01:58:08.000Z">07-25-2021</time></p><p class="title"><a href="/2021/07/25/Ultra-fast-Thunderbolt-NAS-with-Apple-M1-and-Linux/">Ultra fast Thunderbolt NAS with Apple M1 and Linux</a></p><p class="categories"><a href="/categories/Homelab/">Homelab</a></p></div></article></div></div><div class="card widget" data-type="categories"><div class="card-content"><div class="menu"><h3 class="menu-label">Categories</h3><ul class="menu-list"><li><a class="level is-mobile" href="/categories/AI/"><span class="level-start"><span class="level-item">AI</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/Crypto/"><span class="level-start"><span class="level-item">Crypto</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/categories/Devops/"><span class="level-start"><span class="level-item">Devops</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Home/"><span class="level-start"><span class="level-item">Home</span></span><span class="level-end"><span class="level-item tag">8</span></span></a></li><li><a class="level is-mobile" href="/categories/Homelab/"><span class="level-start"><span class="level-item">Homelab</span></span><span class="level-end"><span class="level-item tag">17</span></span></a></li><li><a class="level is-mobile" href="/categories/Linux/"><span class="level-start"><span class="level-item">Linux</span></span><span class="level-end"><span class="level-item tag">11</span></span></a></li><li><a class="level is-mobile" href="/categories/Politics/"><span class="level-start"><span class="level-item">Politics</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Professional/"><span class="level-start"><span class="level-item">Professional</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Projects/"><span class="level-start"><span class="level-item">Projects</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/categories/Software/"><span class="level-start"><span class="level-item">Software</span></span><span class="level-end"><span class="level-item tag">7</span></span></a></li><li><a class="level is-mobile" href="/categories/Telematics/"><span class="level-start"><span class="level-item">Telematics</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/categories/Web/"><span class="level-start"><span class="level-item">Web</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></div></div></div></div></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/images/logo.png" alt="Chris Bergeron Tech Blog" height="28" width="288"></a><p class="is-size-7"><span>&copy; 2021 Chris Bergeron</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="RSS" href="https://chrisbergeron.com/atom.xml"><i class="fa fa-rss fa-1x"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="GitHub" href="https://github.com/chrisbergeron/"><i class="fab fa-github"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Medium" href="https://c-bergeron.medium.com/"><i class="fab fa-medium"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Ethereum" href="ethereum://0xA44E17eA422A0D7AA97C6F805E37b1aBB934171d"><i class="fab fa-ethereum"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" async></script><script>moment.locale("en");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><a id="back-to-top" title="Back to top" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "This website uses cookies to improve your experience.",
          dismiss: "Got it!",
          allow: "Allow cookies",
          deny: "Decline",
          link: "Learn more",
          policy: "Cookie Policy",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="Type something..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"Type something...","untitled":"(Untitled)","posts":"Posts","pages":"Pages","categories":"Categories","tags":"Tags"});
        });</script></body></html>